# Override base chart values for login-service
aioc-hospital-base:
  nameOverride: login-service
  fullnameOverride: login-service
  replicaCount: 1
  imagePullSecrets:
    - name: ghcr-pull-secret
  image:
    repository: ghcr.io/siesta94/login-service
    pullPolicy: IfNotPresent
    tag: "latest"
  service:
    type: ClusterIP
    port: 8000
  # Secrets: login-service-secrets (DATABASE_URL) + aioc-hospital-jwt-secret (SECRET_KEY, shared). See argocd/SECRETS.md
  env:
    - name: DATABASE_URL
      valueFrom:
        secretKeyRef:
          name: login-service-secrets
          key: DATABASE_URL
    - name: SECRET_KEY
      valueFrom:
        secretKeyRef:
          name: aioc-hospital-jwt-secret
          key: SECRET_KEY
    - name: ALGORITHM
      value: "HS256"
    - name: ACCESS_TOKEN_EXPIRE_MINUTES
      value: "480"
    - name: ALLOWED_ORIGINS
      value: "https://my-hospital.aioc-services.com,http://my-hospital.aioc-services.com,http://localhost:3000,http://127.0.0.1:3000"
    - name: SEED_DEFAULT_USERS
      value: "true"
  livenessProbe:
    httpGet:
      path: /health
      port: http
  readinessProbe:
    httpGet:
      path: /health
      port: http
  httpRoute:
    enabled: true
    parentRefs:
      - name: main-gateway
        namespace: kube-system
        kind: Gateway
        sectionName: http
      - name: main-gateway
        namespace: kube-system
        kind: Gateway
        sectionName: https
    hostnames:
      - login.aioc-services.com
    rules:
      - matches:
          - path:
              type: PathPrefix
              value: /
